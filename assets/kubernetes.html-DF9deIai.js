import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as i,o as e}from"./app-GviURCoX.js";const l={};function p(t,s){return e(),a("div",null,s[0]||(s[0]=[i(`<h1 id="kubernetes" tabindex="-1"><a class="header-anchor" href="#kubernetes"><span>kubernetes</span></a></h1><h2 id="k8s集群搭建" tabindex="-1"><a class="header-anchor" href="#k8s集群搭建"><span>k8s集群搭建</span></a></h2><p><a href="https://docs.k3s.io/zh/" target="_blank" rel="noopener noreferrer">K3s - 轻量级 Kubernetes | K3s</a></p><h2 id="配置私有仓库" tabindex="-1"><a class="header-anchor" href="#配置私有仓库"><span>配置私有仓库</span></a></h2><p>在/etc/rancher/k3s创建registries.yaml</p><p>registries.yaml</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">mirrors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  &quot;xxx.xxx.xxx.xxx:xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    endpoint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://xxx.xxx.xxx.xxx:xxx&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">configs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  &quot;xxx.xxx.xxx.xxx:xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    tls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      insecure_skip_verify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置代理" tabindex="-1"><a class="header-anchor" href="#配置代理"><span>配置代理</span></a></h2><p>在/etc/systemd/system/k3s-agent.service.env中添加以下内容</p><div class="language-env line-numbers-mode" data-highlighter="shiki" data-ext="env" data-title="env" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>HTTP_PROXY=http://xxx.xxx.xxx.xxx:xxx</span></span>
<span class="line"><span>HTTPS_PROXY=http://xxx.xxx.xxx.xxx:xxx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="外部访问k3s集群" tabindex="-1"><a class="header-anchor" href="#外部访问k3s集群"><span>外部访问k3s集群</span></a></h2><p>kubeconfig: /etc/rancher/k3s/k3s.yaml</p><h2 id="pod" tabindex="-1"><a class="header-anchor" href="#pod"><span>pod</span></a></h2><ul><li>pod是k8s的基本单元</li></ul><h3 id="编写一个简单的pod" tabindex="-1"><a class="header-anchor" href="#编写一个简单的pod"><span>编写一个简单的pod</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>apiVersion: v1</span></span>
<span class="line"><span>kind: Pod</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: busbox</span></span>
<span class="line"><span>  namespace: test</span></span>
<span class="line"><span>  labels:</span></span>
<span class="line"><span>    app: busbox</span></span>
<span class="line"><span></span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>  containers:</span></span>
<span class="line"><span>  - name: busybox</span></span>
<span class="line"><span>    image: busbox</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pod定义参数" tabindex="-1"><a class="header-anchor" href="#pod定义参数"><span>pod定义参数</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>apiVersion: v1</span></span>
<span class="line"><span>kind: Pod</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>	name: busybox</span></span>
<span class="line"><span>	namespace: test</span></span>
<span class="line"><span>	labels:</span></span>
<span class="line"><span>		app: busybox</span></span>
<span class="line"><span></span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>	# 网络相关</span></span>
<span class="line"><span>	# 是否使用宿主机网络</span></span>
<span class="line"><span>	hostNetwork: true</span></span>
<span class="line"><span>	# dns策略 可选值：Default|ClusterFirst|ClusterFirstWithHostNet|None</span></span>
<span class="line"><span>	dnsPolicy: &quot;Default&quot;</span></span>
<span class="line"><span>	# dns配置</span></span>
<span class="line"><span>	dnsConfig:</span></span>
<span class="line"><span>		nameservers:</span></span>
<span class="line"><span>		- 8.8.8.8</span></span>
<span class="line"><span>	# 域名映射</span></span>
<span class="line"><span>	hostAliases:</span></span>
<span class="line"><span>		- ip: 192.168.1.1</span></span>
<span class="line"><span>		  hostnames:</span></span>
<span class="line"><span>		  - &quot;foo.local&quot;</span></span>
<span class="line"><span>		  - &quot;bar.local&quot;</span></span>
<span class="line"><span>	containers:</span></span>
<span class="line"><span>	- name: busybox</span></span>
<span class="line"><span>		image: busybox</span></span>
<span class="line"><span>		# 镜像拉取策略，可选值： Always(主动拉取)|IfNotPresent(镜像存在则不拉去)|Never(不拉取)</span></span>
<span class="line"><span>		imagePullPolicy: IfNotPresent</span></span>
<span class="line"><span>		# 环境变量</span></span>
<span class="line"><span>		env:</span></span>
<span class="line"><span>		- name: app</span></span>
<span class="line"><span>		  value: busybox</span></span>
<span class="line"><span>		# 运行终端</span></span>
<span class="line"><span>		tty: true</span></span>
<span class="line"><span>		# 资源分配</span></span>
<span class="line"><span>		resources:</span></span>
<span class="line"><span>			# 申请的最低资源配额</span></span>
<span class="line"><span>			request:</span></span>
<span class="line"><span>				# 100m内存</span></span>
<span class="line"><span>				memory: &quot;100Mi&quot;</span></span>
<span class="line"><span>				# 一核</span></span>
<span class="line"><span>				cpu: &quot;1000m&quot;</span></span>
<span class="line"><span>			# pod的最大资源值</span></span>
<span class="line"><span>			limit:</span></span>
<span class="line"><span>				memory: &quot;200Mi&quot;</span></span>
<span class="line"><span>				cpu: &quot;1000m&quot;</span></span>
<span class="line"><span>		# 特权模式</span></span>
<span class="line"><span>		securityContext:</span></span>
<span class="line"><span>			privileged: true</span></span>
<span class="line"><span>		# 工作目录</span></span>
<span class="line"><span>		workingDir: /test</span></span>
<span class="line"><span>		# 命令</span></span>
<span class="line"><span>		command: [&quot;/bin/sh&quot;]</span></span>
<span class="line"><span>		# 运行参数</span></span>
<span class="line"><span>		args: [&quot;-c&quot;, &quot;while true; do echo hello; sleep 10; done&quot;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18)]))}const c=n(l,[["render",p],["__file","kubernetes.html.vue"]]),h=JSON.parse('{"path":"/linux/kubernetes.html","title":"kubernetes","lang":"zh-CN","frontmatter":{"description":"kubernetes k8s集群搭建 K3s - 轻量级 Kubernetes | K3s 配置私有仓库 在/etc/rancher/k3s创建registries.yaml registries.yaml 配置代理 在/etc/systemd/system/k3s-agent.service.env中添加以下内容 外部访问k3s集群 kubeconf...","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://gouwang.top/linux/kubernetes.html"}],["meta",{"property":"og:title","content":"kubernetes"}],["meta",{"property":"og:description","content":"kubernetes k8s集群搭建 K3s - 轻量级 Kubernetes | K3s 配置私有仓库 在/etc/rancher/k3s创建registries.yaml registries.yaml 配置代理 在/etc/systemd/system/k3s-agent.service.env中添加以下内容 外部访问k3s集群 kubeconf..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"kubernetes\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"lcc\\",\\"url\\":\\"https://gouwang.top\\"}]}"]]},"headers":[{"level":2,"title":"k8s集群搭建","slug":"k8s集群搭建","link":"#k8s集群搭建","children":[]},{"level":2,"title":"配置私有仓库","slug":"配置私有仓库","link":"#配置私有仓库","children":[]},{"level":2,"title":"配置代理","slug":"配置代理","link":"#配置代理","children":[]},{"level":2,"title":"外部访问k3s集群","slug":"外部访问k3s集群","link":"#外部访问k3s集群","children":[]},{"level":2,"title":"pod","slug":"pod","link":"#pod","children":[{"level":3,"title":"编写一个简单的pod","slug":"编写一个简单的pod","link":"#编写一个简单的pod","children":[]},{"level":3,"title":"pod定义参数","slug":"pod定义参数","link":"#pod定义参数","children":[]}]}],"readingTime":{"minutes":0.95,"words":284},"filePathRelative":"linux/kubernetes.md","excerpt":"\\n<h2>k8s集群搭建</h2>\\n<p><a href=\\"https://docs.k3s.io/zh/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">K3s - 轻量级 Kubernetes | K3s</a></p>\\n<h2>配置私有仓库</h2>\\n<p>在/etc/rancher/k3s创建registries.yaml</p>\\n<p>registries.yaml</p>\\n<div class=\\"language-yaml line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"yaml\\" data-title=\\"yaml\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">---</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">mirrors</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  \\"xxx.xxx.xxx.xxx:xxx\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">    endpoint</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">      - </span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"http://xxx.xxx.xxx.xxx:xxx\\"</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">configs</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  \\"xxx.xxx.xxx.xxx:xxx\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">    tls</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">:</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">      insecure_skip_verify</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">: </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">true</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{c as comp,h as data};
