import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as n,o as e}from"./app-DOGfZyh0.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="mysql学习" tabindex="-1"><a class="header-anchor" href="#mysql学习"><span>mysql学习</span></a></h1><h2 id="mysql8-0设置主从复制" tabindex="-1"><a class="header-anchor" href="#mysql8-0设置主从复制"><span>mysql8.0设置主从复制</span></a></h2><h3 id="主机配置" tabindex="-1"><a class="header-anchor" href="#主机配置"><span>主机配置</span></a></h3><h4 id="配置mysqld" tabindex="-1"><a class="header-anchor" href="#配置mysqld"><span>配置mysqld</span></a></h4><p>/etc/mysql/mysql.conf.d/mysqld.cnf</p><div class="language-conf line-numbers-mode" data-highlighter="shiki" data-ext="conf" data-title="conf" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>server-id=1</span></span>
<span class="line"><span>log-bin=mysql-bin</span></span>
<span class="line"><span>binlog-format=ROW</span></span>
<span class="line"><span>expire-logs-days=10</span></span>
<span class="line"><span>gtid_mode=ON</span></span>
<span class="line"><span>enforce_gtid_consistency=ON</span></span>
<span class="line"><span></span></span>
<span class="line"><span>binlog-do-db=xxx1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重启mysql" tabindex="-1"><a class="header-anchor" href="#重启mysql"><span>重启mysql</span></a></h4><p><code>systemctl restart mysql</code></p><h4 id="创建复制用户并授权" tabindex="-1"><a class="header-anchor" href="#创建复制用户并授权"><span>创建复制用户并授权</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&#39;@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> IDENTIFIED </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WITH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mysql_native_password </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Test123456&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">GRANT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> REPLICATION SLAVE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> *.* </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">TO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;test&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看主库状态-记录-file和-position" tabindex="-1"><a class="header-anchor" href="#查看主库状态-记录-file和-position"><span><strong>查看主库状态</strong>，记录 <code>File</code>和 <code>Position</code>：</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SHOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">MASTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="导出表结构并复制到从机上" tabindex="-1"><a class="header-anchor" href="#导出表结构并复制到从机上"><span>导出表结构并复制到从机上</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mysqldump -u </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -p </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">--all-databases --set-gtid-purged=OFF &gt; all_data.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="从机配置" tabindex="-1"><a class="header-anchor" href="#从机配置"><span>从机配置</span></a></h3><h4 id="配置mysqld-1" tabindex="-1"><a class="header-anchor" href="#配置mysqld-1"><span>配置mysqld</span></a></h4><p>/etc/mysql/mysql.conf.d/mysqld.cnf</p><div class="language-conf line-numbers-mode" data-highlighter="shiki" data-ext="conf" data-title="conf" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>server-id=2</span></span>
<span class="line"><span>relay-log=mysql-relay-bin</span></span>
<span class="line"><span>log-bin=mysql-bin  # 从库也可以记录binlog</span></span>
<span class="line"><span>read-only=1</span></span>
<span class="line"><span>gtid_mode=ON</span></span>
<span class="line"><span>enforce_gtid_consistency=ON</span></span>
<span class="line"><span></span></span>
<span class="line"><span>replicate-do-db=xxx1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重启mysql-1" tabindex="-1"><a class="header-anchor" href="#重启mysql-1"><span>重启mysql</span></a></h4><p><code>systemctl restart mysql</code></p><h4 id="导入表结构" tabindex="-1"><a class="header-anchor" href="#导入表结构"><span>导入表结构</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mysql -uroot -p </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> all_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="连接主库" tabindex="-1"><a class="header-anchor" href="#连接主库"><span><strong>连接主库</strong>：</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">CHANGE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">MASTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TO</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_HOST</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;主库IP&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;test&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Test123456&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_LOG_FILE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;主库File值&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_LOG_POS</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">主库Position值;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MASTER_AUTO_POSITION</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看从机状态" tabindex="-1"><a class="header-anchor" href="#查看从机状态"><span>查看从机状态</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SHOW SLAVE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看以下参数值：</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Slave_IO_Running: Yes</span></span>
<span class="line"><span>Slave_SQL_Running: Yes</span></span>
<span class="line"><span>Seconds_Behind_Master: 0</span></span>
<span class="line"><span>Last_SQL_Error: (空)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28)]))}const r=i(l,[["render",t],["__file","mysql.html.vue"]]),k=JSON.parse('{"path":"/linux/mysql.html","title":"mysql学习","lang":"zh-CN","frontmatter":{"description":"mysql学习 mysql8.0设置主从复制 主机配置 配置mysqld /etc/mysql/mysql.conf.d/mysqld.cnf 重启mysql systemctl restart mysql 创建复制用户并授权 查看主库状态，记录 File和 Position： 导出表结构并复制到从机上 从机配置 配置mysqld /etc/mysql...","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/linux/mysql.html"}],["meta",{"property":"og:site_name","content":"lcc博客"}],["meta",{"property":"og:title","content":"mysql学习"}],["meta",{"property":"og:description","content":"mysql学习 mysql8.0设置主从复制 主机配置 配置mysqld /etc/mysql/mysql.conf.d/mysqld.cnf 重启mysql systemctl restart mysql 创建复制用户并授权 查看主库状态，记录 File和 Position： 导出表结构并复制到从机上 从机配置 配置mysqld /etc/mysql..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"mysql学习\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"lcc\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"mysql8.0设置主从复制","slug":"mysql8-0设置主从复制","link":"#mysql8-0设置主从复制","children":[{"level":3,"title":"主机配置","slug":"主机配置","link":"#主机配置","children":[]},{"level":3,"title":"从机配置","slug":"从机配置","link":"#从机配置","children":[]}]}],"readingTime":{"minutes":0.75,"words":226},"filePathRelative":"linux/mysql.md","excerpt":"\\n<h2>mysql8.0设置主从复制</h2>\\n<h3>主机配置</h3>\\n<h4>配置mysqld</h4>\\n<p>/etc/mysql/mysql.conf.d/mysqld.cnf</p>\\n<div class=\\"language-conf line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"conf\\" data-title=\\"conf\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>server-id=1</span></span>\\n<span class=\\"line\\"><span>log-bin=mysql-bin</span></span>\\n<span class=\\"line\\"><span>binlog-format=ROW</span></span>\\n<span class=\\"line\\"><span>expire-logs-days=10</span></span>\\n<span class=\\"line\\"><span>gtid_mode=ON</span></span>\\n<span class=\\"line\\"><span>enforce_gtid_consistency=ON</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>binlog-do-db=xxx1</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{r as comp,k as data};
